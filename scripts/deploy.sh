#!/bin/bash

# λ°°ν¬ μ¤ν¬λ¦½νΈ
# μ΄ μ¤ν¬λ¦½νΈλ” λ΅μ»¬μ—μ„ λ°°ν¬λ¥Ό ν…μ¤νΈν•κ±°λ‚ μλ™μΌλ΅ λ°°ν¬ν•  λ• μ‚¬μ©ν•©λ‹λ‹¤.

set -e  # μ—λ¬ λ°μƒ μ‹ μ¤ν¬λ¦½νΈ μ¤‘λ‹¨

echo "π€ ν¬νΈν΄λ¦¬μ¤ λ°°ν¬λ¥Ό μ‹μ‘ν•©λ‹λ‹¤..."

# Node.js λ²„μ „ ν™•μΈ
echo "π“‹ Node.js λ²„μ „ ν™•μΈ μ¤‘..."
node --version
npm --version

# μμ΅΄μ„± μ„¤μΉ
echo "π“¦ μμ΅΄μ„± μ„¤μΉ μ¤‘..."
npm ci

# λ¦°νΈ κ²€μ‚¬
echo "π” μ½”λ“ ν’μ§ κ²€μ‚¬ μ¤‘..."
npm run lint

# λΉλ“
echo "π—οΈ ν”„λ΅λ•μ… λΉλ“ μ¤‘..."
npm run build

# λΉλ“ κ²°κ³Ό ν™•μΈ
if [ -d "dist" ]; then
    echo "β… λΉλ“κ°€ μ„±κ³µμ μΌλ΅ μ™„λ£λμ—μµλ‹λ‹¤!"
    echo "π“ λΉλ“ κ²°κ³Όλ¬Ό ν¬κΈ°:"
    du -sh dist/
else
    echo "β λΉλ“ μ‹¤ν¨: dist λ””λ ‰ν† λ¦¬κ°€ μƒμ„±λμ§€ μ•μ•μµλ‹λ‹¤."
    exit 1
fi

echo "π‰ λ°°ν¬ μ¤€λΉ„κ°€ μ™„λ£λμ—μµλ‹λ‹¤!"
echo "π“ λ‹¤μ λ‹¨κ³„:"
echo "   1. GitHubμ— μ½”λ“λ¥Ό pushν•μ„Έμ”"
echo "   2. GitHub Actionsκ°€ μλ™μΌλ΅ λ°°ν¬λ¥Ό μ§„ν–‰ν•©λ‹λ‹¤"
echo "   3. λλ” μλ™μΌλ΅ λ°°ν¬ ν”λ«νΌμ— μ—…λ΅λ“ν•μ„Έμ”"
